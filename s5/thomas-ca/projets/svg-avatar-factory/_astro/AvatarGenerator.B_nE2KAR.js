import{s as c,j as e}from"./supabaseClient.Dr4kaC94.js";import{r as s}from"./index.RH_Wq4ov.js";const v="https://ryfsbluxhytxrtopxaqi.supabase.co/functions/v1/generate-avatar";function m(){const[t,l]=s.useState(null),[a,n]=s.useState(!1),[o,d]=s.useState(null);s.useEffect(()=>{(async()=>{const{data:{session:u}}=await c.auth.getSession();d(u?.user??null),n(!1)})();const{data:i}=c.auth.onAuthStateChange((u,h)=>{d(h?.user??null)});return()=>{i.subscription.unsubscribe()}},[]);async function p(){n(!0),l(null);const i=await(await fetch(v,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})})).json();l(i.svg),n(!1)}function x(){t&&navigator.clipboard.writeText(t)}const f=async()=>{if(o)try{const{error:r}=await c.from("favorites").insert({user_id:o.id,svg:t});if(r)throw r;window.dispatchEvent(new CustomEvent("favoriteAdded"))}catch(r){console.error(r),alert("Erreur lors de l'ajout en favoris")}};return e.jsxs("div",{className:"border border-green-500 p-4 rounded-xl",children:[e.jsx("h2",{className:"text-xl mb-2",children:"üé® G√©n√©rateur d‚Äôavatars"}),e.jsxs("div",{className:"bg-black border border-green-700 h-40 flex items-center justify-center overflow-auto p-2",children:[a&&e.jsx("p",{children:"‚è≥ G√©n√©ration..."}),!a&&t&&e.jsx("div",{dangerouslySetInnerHTML:{__html:t}}),!a&&!t&&e.jsx("p",{children:"Aucun avatar g√©n√©r√©"})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{onClick:p,className:"bg-green-700 px-4 py-2 rounded",children:"G√©n√©rer un avatar"}),t&&e.jsx("button",{onClick:x,className:"bg-green-900 px-4 py-2 rounded",children:"Copier le SVG"}),t&&(o?e.jsx("button",{onClick:f,disabled:!t,className:"bg-green-700 px-4 py-2 rounded",children:"‚≠ê Favori"}):e.jsx("p",{children:"Connectez-vous pour sauvegarder"}))]})]})}export{m as default};
